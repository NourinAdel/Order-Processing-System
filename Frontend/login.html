<!DOCTYPE html>
<html>
<head>
    <title>Book Ordering Website</title>
    <style>
        .LoginForm {
            display: none;
        }
    </style>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    
<h1>Welcome to Our Bookstore!</h1>
<h2>Please choose your role.</h2>

<div class="FormDiv">

<button class="Form" id="AdminLoginButton">Admin</button><br> 
<button class="Form" id="CustomerLoginButton">Customer</button><br>
<br>
<form class="LoginForm" id="AdminLoginForm" method="POST" action="../admin/process_files/process_login.php"> 
    <h3>Admin Login</h3>  
    <label for="username">Username:</label>
    <input type="text" id="username" name="username"><br>
    <label for="password">Password:</label> 
    <input type="password" id="password" name="password"><br>
    <p id="admin-error-msg" style="color: rgb(227, 116, 116); font-weight: bold;text-align: center;"></p>
    <br>
    <input type="submit" value="Login">

</form>

<form class="LoginForm" id="CustomerLoginForm">
    <h3>Customer Login</h3>
    <input type="text" name="username" placeholder="Username">
    <input type="password" name="password" placeholder="Password">
    <p id="customer-error" style="color:red;"></p>
    <button type="submit">Login</button>
    <p>
        No account?
        <a href="#" id="showRegister">Sign up</a>
    </p>
</form>

<form class="LoginForm" id="CustomerRegisterForm">
    <h3>Customer Sign Up</h3>
    <input name="username" placeholder="Username">
    <input name="password" type="password" placeholder="Password">
    <input name="first_name" placeholder="First name">
    <input name="last_name" placeholder="Last name">
    <input name="email" placeholder="Email">
    <input name="phone" placeholder="Phone">
    <input name="shipping_address" placeholder="Shipping address">
    <p id="register-error" style="color:red;"></p>
    <button type="submit">Register</button>
</form>
</div>

<script>
const adminBtn = document.getElementById('AdminLoginButton');
const customerBtn = document.getElementById('CustomerLoginButton');

const adminForm = document.getElementById('AdminLoginForm');
const customerForm = document.getElementById('CustomerLoginForm');
const registerForm = document.getElementById('CustomerRegisterForm');

adminBtn.onclick = () => {
    adminForm.style.display = 'block';
    customerForm.style.display = 'none';
    registerForm.style.display = 'none';
};

customerBtn.onclick = () => {
    customerForm.style.display = 'block';
    adminForm.style.display = 'none';
    registerForm.style.display = 'none';
};

document.getElementById('showRegister').onclick = () => {
    registerForm.style.display = 'block';
    customerForm.style.display = 'none';
};

adminForm.onsubmit = e => {
    e.preventDefault();
    fetch('../admin/process_files/process_login.php', {
        method: 'POST',
        body: new FormData(adminForm)
    })
    .then(r => r.json())
    .then(d => {
        if (d.success) location.href = 'adminrole.html';
        else document.getElementById('admin-error').innerText = d.error;
    });
};

customerForm.onsubmit = e => {
    e.preventDefault();
    fetch('../customer/login.php', {
        method: 'POST',
        body: new FormData(customerForm)
    })
    .then(r => r.json())
    .then(d => {
        if (d.success) location.href = 'customerrole.html';
        else document.getElementById('customer-error').innerText = d.message;
    });
};

registerForm.onsubmit = e => {
    e.preventDefault();
    fetch('../customer/register.php', {
        method: 'POST',
        body: new FormData(registerForm)
    })
    .then(r => r.json())
    .then(d => {
        if (d.success) {
            alert("Account created. Please log in.");
            registerForm.style.display = 'none';
            customerForm.style.display = 'block';
        } else {
            document.getElementById('register-error').innerText = d.message;
        }
    });
};
</script>

</body>
</html>